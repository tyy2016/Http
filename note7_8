7
缓存
缓存优势：减少重复数据传输；降低源站压力；减少时延
命中：用缓存中已有的资源响应客户端的请求
未命中：本地没有缓存而需要转发给原始服务器
常用If-Modified-Since首部来对缓存对象进行再验证，与GET请求一起发送到服务器端
如果服务器端文件未改变，返回304 Not Modified响应
如果服务器端改变了，返回200OK和带有完整内容的响应
如果服务器端对象不存在，返回404 Not Found响应
命中率：由缓存提供服务的请求所占的比例（接近100%最好）
字节命中率：缓存提供的字节在传输的所有字节中所占比例，可借此评估节省流量的程度，可节省带宽
文档命中率：可减少通往外部的web事务，可降低整体延迟
如何区分命中还是未命中：从源站还是缓存中吐出的信息响应码都是200 OK，一些代理会在via首部中附加信息以描述是否命中缓存等。客户端可通过Date首部来判断响应是否来自缓存。
缓存处理步骤：
1.接收请求
2.解析
3.查找缓存。无缓存请求源站，缓存源站给的响应主体和响应头部
4.新鲜度检测。如果超过了过期时间，一定会与源站进行新鲜度确认
5.响应。缓存会对源站的响应头做修改和扩充，与客户端的要求匹配。Date首部是源站给的，不应修改。
6.发送
7.生成记录日志
保持缓存的新鲜：不需要知道有哪些缓存缓存了副本而保持缓存和源站的一致性。
文档过期：Expire首部（绝对时间）；Cache-Control首部（相对时间，最大的合法生存时间）
服务器再验证：内容发生了变化缓存新的副本和新的首部。内容无变化，只缓存新的响应首部，包含新的过期时间。
条件方法的再验证：新鲜度检测和对象获取结合成单个条件的GET。If-Modified-Since条件为真时web才会返回对象。
If-Modified-Since常与Last-Modified结合使用
服务器控制缓存的缓存能力：在文档过期之前指定将其缓存多长时间，cache-control头部
no-store：禁止缓存复制，向客户端转发完后，发送no-store响应，然后本地删除对象
no-cache：可以存储在本地，在与源站进行新鲜度校验之前不会提供给客户端
max-age：从源站都到副本开始，副本处于新鲜状态的秒数
must-revalidate：在没有和源站进行验证的情况下不能提供陈旧的副本

8
网关
网关：抽象出到达资源的方法，向数据库发送查询语句或生成动态内容，进去一条请求出来一条响应。
服务器端web网关：HTTP/*。请求流向原始服务器时，服务器端网关会将HTTP请求转换成其他协议
服务器端安全网关：HTTP/HTTPS
客户端安全网关：HTTPS/HTTP
隧道：允许HTTP协议携带非HTTP的流量穿过只允许web流量通过的防火墙
中继：负责处理http中建立连接的部分

